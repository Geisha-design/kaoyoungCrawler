# 爬虫助手浏览器插件

这是一个Chrome浏览器扩展，作为爬虫助手系统的客户端，与后端服务通过WebSocket进行实时通信。

## 功能特性

- JWT身份认证
- WebSocket双向实时通信
- 支持JS爬取脚本的批量下发和定向下发
- 网站爬取调度（根据域名自动匹配脚本）
- 定时任务管理
- 爬取结果上传

## 安装方法

### 开发者模式安装

1. 打开Chrome浏览器，进入 `chrome://extensions/`
2. 开启右上角的“开发者模式”
3. 点击“加载已解压的扩展程序”
4. 选择本目录（browser_extension）

### 所需权限说明

- `storage`: 存储JWT令牌和用户配置
- `tabs`: 监听标签页URL变化
- `alarms`: 管理定时任务
- `<all_urls>`: 访问所有网站以执行爬取脚本

## 使用方法

1. 点击浏览器工具栏中的爬虫助手图标
2. 输入用户名和密码（默认 admin/123456）
3. 登录成功后会自动连接到后端WebSocket服务
4. 插件将接收后端下发的爬取脚本
5. 当访问匹配的网站时，会自动提示是否执行相应脚本

## 核心功能

### 1. 脚本执行
- 后端可批量下发或定向下发爬取脚本
- 插件接收脚本并缓存
- 支持根据域名自动匹配和执行脚本

### 2. 定时任务
- 通过 `task-manager.html` 页面管理定时任务
- 支持任务的添加、编辑、删除、启用/禁用
- 基于Chrome Alarms API实现定时执行

### 3. 结果上传
- 执行爬取脚本后自动将结果上传到后端
- 支持即时任务和定时任务的结果上传

## 文件结构

```
browser_extension/
├── manifest.json          # 扩展配置文件
├── popup.html            # 弹出窗口界面
├── login.js              # 登录逻辑
├── background.js         # 后台脚本（核心逻辑）
├── content.js            # 内容脚本（页面内执行）
├── task-manager.html     # 定时任务管理页面
├── task-manager.js       # 定时任务管理逻辑
└── icons/                # 图标文件夹
```

## 配置要求

- Chrome浏览器版本 90+
- 后端服务运行在 `http://localhost:8080/smarteCrawler`（可在代码中修改）
- MySQL数据库已正确配置

## 故障排除

如果遇到连接问题：

1. 确保后端服务正在运行
2. 检查网络连接和防火墙设置
3. 确认JWT令牌有效
4. 查看浏览器控制台和后端日志获取详细错误信息